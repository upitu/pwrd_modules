<odoo>
  <template id="bids_marketplace_template" name="Bids Marketplace">
    <t t-call="website.layout">
      <div class="container py-4 px-5">
        <div class="row">
          <h4 class="mb-3">Marketplace</h4>
          <!-- ðŸ” Sidebar Filters -->
          <div class="col-md-3">
            <form method="get" action="/bids/marketplace" class="card p-3 shadow-sm" style="background-color: #E0E0E0;border-radius: 14px !inportant;">
              <h5>Filters</h5>

              <!-- Energy Types -->
              <div class="mb-3">
                <label class="form-label">Energy Types</label>
                <t t-foreach="energy_types" t-as="etype">
                  <div class="form-check">
                    <input type="radio" class="form-check-input" name="energy_type"
                          t-att-value="etype['value']"
                          t-att-checked="filters.get('energy_type') == etype['value']"/>
                    <label class="form-check-label" t-esc="etype['label']"/>
                  </div>
                </t>
              </div>

              <!-- Amount Ordered -->
              <div class="mb-3">
                <label class="form-label">Amount Ordered</label>
                <div class="d-flex gap-2">
                  <input class="form-control" type="number" name="min_volume" min="0" placeholder="Min"
                    t-att-value="filters.get('min_volume')"/>
                  <input class="form-control" type="number" name="max_volume" min="0" placeholder="Max"
                    t-att-value="filters.get('max_volume')"/>
                </div>
              </div>

              <!-- Location -->
              <div class="mb-3">
                <label class="form-label">Location</label>
                <select class="form-select" name="location">
                  <option value="">Select Location</option>
                  <t t-foreach="locations" t-as="loc">
                    <option t-att-value="loc.id"
                            t-att-selected="filters.get('location') and int(filters.get('location')) == loc.id">
                      <t t-esc="loc.name"/>
                    </option>
                  </t>
                </select>
              </div>

              <button class="btn btn-primary w-100 mt-3" type="submit">Apply Filters</button>
            </form>
          </div>

          <!-- ðŸ§¾ Marketplace Bid Cards -->
          <div class="col-md-9">
            <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-3">
              <t t-if="bids">
                <t t-foreach="bids" t-as="bid">
                  <div class="col">
                    <!-- Card for each bid start -->
                    <div class="card-bids h-100 shadow-sm">
                      <div class="card-body">
                        <div class="card-upper">
                          <div class="d-flex justify-content-between align-items-center mb-3" style="
                              justify-content: space-between;
                          ">
                            <!-- Left: Avatar + Name + Location -->
                            <div class="d-flex align-items-center">
                              <img src="/energy_marketplace/static/src/img/marketplace_placeholder.png" alt="Avatar" width="50" height="50" class="rounded border border-blue-medium me-3"/>
                              <div style="float: right;">
                                <strong t-if="bid.company_id" t-esc="bid.company_id.company_name"/>
                                <div class="text-muted small d-flex align-items-center">
                                  <img src="/energy_marketplace/static/src/img/location_pin.png" alt="Location" width="12" height="13" class="me-1"/>
                                  <span class="text-muted small" t-if="bid.location" t-esc="bid.location.name"/>
                                </div>
                              </div>
                            </div>

                            <!-- Right: Date -->
                            <div class="text-end text-muted small" style="align-self: self-start;" t-esc="bid.create_date.strftime('%d %b, %Y')"/>
                          </div>
                          <div class="d-flex justify-content-between text-center pt-3 pb-2">
                            <div>
                              <div class="text-muted text-xs">Energy Type</div>
                              <div class="fw-medium" t-esc="bid.energy_type.title()"/>
                            </div>
                            <div style="height:inherit;width:1px;background:#E0E0E0;"></div>
                            <div>
                              <div class="text-muted text-xs">Amount Ordered</div>
                              <div class="fw-medium">
                                <t t-esc="'{:,}'.format(int(bid.volume_requested))"/> L
                              </div>
                            </div>
                            <div style="height:inherit;width:1px;background:#E0E0E0;"></div>
                            <div>
                              <div class="text-muted text-xs">Total Bids</div>
                              <div class="fw-medium">
                                <t t-if="'supplier_bid_ids' in bid" t-esc="len(bid.supplier_bid_ids)"/>
                                <t t-if="'supplier_bid_ids' not in bid">0</t>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="card-bottom d-flex justify-content-between">
                          <a href="#" class="learn-more btn btn-outline-primary btn-sm"
                            t-att-data-bid-id="bid.id"
                            data-bs-toggle="modal"
                            data-bs-target="#bidDetailsModal"
                            t-attf-data-url="/bids/#{bid.id}?modal=1">
                            Learn More
                          </a>

                          <t t-if="is_authenticated and is_supplier">
                            <a href="#"
                              class="bid-button btn-sm"
                              data-bs-toggle="modal"
                              data-bs-target="#bidSubmitModal"
                              t-attf-data-url="/bids/#{bid.id}/submit">
                              Bid
                            </a>
                          </t>

                          <t t-if="is_authenticated and not is_supplier">
                            <a href="#" class="btn btn-secondary btn-sm disabled" title="Only suppliers can bid">Bid</a>
                          </t>

                          <t t-if="not is_authenticated">
                            <a href="/web/login?redirect=/bids/marketplace" class="login-bid btn btn-outline-primary btn-sm">Login to Bid</a>
                          </t>
                        </div>
                      </div>
                    </div>
                    <!-- Card for each bid start -->
                  </div>
                </t>
              </t>
              <t t-if="not bids">
                <div class="col">
                  <p>No bids found. Try adjusting your filters.</p>
                </div>
              </t>
            </div>
          </div>
        </div>
      </div>
      <div class="modal fade" id="bidDetailsModal" tabindex="-1" aria-hidden="true">
        <div class="custom-modal modal-dialog modal-lg modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-body" id="bid-details-content">
              <div class="text-center py-5">
                <span class="spinner-border text-primary"></span>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal fade" id="bidSubmitModal" tabindex="-1" aria-hidden="true">
        <div class="custom-modal modal-dialog modal-lg">
          <div class="modal-content" id="bidModalContent">
            <!-- Dynamic content will be injected here -->
          </div>
        </div>
      </div>
      <div class="toast-container position-fixed bottom-0 end-0 p-3" id="toast-container"></div>
    </t>
  </template>
</odoo>